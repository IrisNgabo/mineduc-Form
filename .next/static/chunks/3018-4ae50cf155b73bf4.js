"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3018],{28883:(e,r,a)=>{a.d(r,{A:()=>t});let t=(0,a(19946).A)("mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]])},30070:(e,r,a)=>{a.d(r,{C5:()=>p,MJ:()=>h,eI:()=>g,lR:()=>f,lV:()=>d,zB:()=>m});var t=a(95155),s=a(12115),l=a(99708),n=a(62177),o=a(53999),i=a(82714);let d=n.Op,c=s.createContext({}),m=e=>{let{...r}=e;return(0,t.jsx)(c.Provider,{value:{name:r.name},children:(0,t.jsx)(n.xI,{...r})})},u=()=>{let e=s.useContext(c),r=s.useContext(x),{getFieldState:a}=(0,n.xW)(),t=(0,n.lN)({name:e.name}),l=a(e.name,t);if(!e)throw Error("useFormField should be used within <FormField>");let{id:o}=r;return{id:o,name:e.name,formItemId:"".concat(o,"-form-item"),formDescriptionId:"".concat(o,"-form-item-description"),formMessageId:"".concat(o,"-form-item-message"),...l}},x=s.createContext({});function g(e){let{className:r,...a}=e,l=s.useId();return(0,t.jsx)(x.Provider,{value:{id:l},children:(0,t.jsx)("div",{"data-slot":"form-item",className:(0,o.cn)("grid gap-2",r),...a})})}function f(e){let{className:r,...a}=e,{error:s,formItemId:l}=u();return(0,t.jsx)(i.J,{"data-slot":"form-label","data-error":!!s,className:(0,o.cn)("data-[error=true]:text-destructive",r),htmlFor:l,...a})}function h(e){let{...r}=e,{error:a,formItemId:s,formDescriptionId:n,formMessageId:o}=u();return(0,t.jsx)(l.DX,{"data-slot":"form-control",id:s,"aria-describedby":a?"".concat(n," ").concat(o):"".concat(n),"aria-invalid":!!a,...r})}function p(e){var r;let{className:a,...s}=e,{error:l,formMessageId:n}=u(),i=l?String(null!=(r=null==l?void 0:l.message)?r:""):s.children;return i?(0,t.jsx)("p",{"data-slot":"form-message",id:n,className:(0,o.cn)("text-destructive text-sm",a),...s,children:i}):null}},34835:(e,r,a)=>{a.d(r,{A:()=>t});let t=(0,a(19946).A)("log-out",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]])},35695:(e,r,a)=>{var t=a(18999);a.o(t,"useParams")&&a.d(r,{useParams:function(){return t.useParams}}),a.o(t,"usePathname")&&a.d(r,{usePathname:function(){return t.usePathname}}),a.o(t,"useRouter")&&a.d(r,{useRouter:function(){return t.useRouter}})},39692:(e,r,a)=>{a.d(r,{A:()=>b});var t=a(95155),s=a(12115),l=a(55594),n=a(62177),o=a(90221),i=a(30070),d=a(89852),c=a(19946);let m=(0,c.A)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);var u=a(71007),x=a(28883);let g=(0,c.A)("at-sign",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M16 8v5a3 3 0 0 0 6 0v-1a10 10 0 1 0-4 8",key:"7n84p3"}]]),f=(0,c.A)("phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);var h=a(81586),p=a(95784),j=a(49026),v=a(35695),y=a(61204);let N=l.z.object({firstName:l.z.string().min(1,"First name is required"),lastName:l.z.string().min(1,"Last name is required"),email:l.z.string().email("Invalid email address"),phonenumber:l.z.string().min(10,"Phone number must be at least 10 digits"),username:l.z.string().min(1,"Username is required"),gender:l.z.enum(["MALE","FEMALE","OTHER"]),national_id:l.z.string().min(1,"National ID is required"),roles:l.z.array(l.z.object({role_name:l.z.string()})).optional()}),b=()=>{let[e,r]=(0,s.useState)(!0),[a,l]=(0,s.useState)(null),[c,b]=(0,s.useState)(!1),[F,w]=(0,s.useState)(!1),[A,B]=(0,s.useState)(null),z=(0,v.useRouter)(),E=(0,n.mN)({resolver:(0,o.u)(N),defaultValues:{firstName:"",lastName:"",email:"",phonenumber:"",username:"",gender:"MALE",national_id:""}});async function I(e){try{if(b(!0),w(!1),!localStorage.getItem("token")){l("You are not authenticated. Please log in."),b(!1);return}console.log("Updated profile values:",e),await new Promise(e=>setTimeout(e,1e3)),w(!0)}catch(e){console.error("Error saving profile:",e),l("Failed to save profile changes. Please try again.")}finally{b(!1)}}return((0,s.useEffect)(()=>{(async()=>{try{r(!0),console.log("Fetching profile data...");let e=localStorage.getItem("access");if(console.log("Token from localStorage:",e?"Found":"Not found"),!e){l("You are not authenticated. Please log in."),r(!1);return}console.log("Making API request to fetch profile...");let a=await fetch("".concat(y.f,"/auth/get-profile"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}});if(console.log("API response status:",a.status),401===a.status){console.error("Authentication failed: 401 Unauthorized"),l("Your session has expired. Please log in again.");return}if(!a.ok)throw Error("Failed to fetch profile: ".concat(a.status));let t=await a.json();console.log("Profile data received:",t),B(t),E.reset({firstName:t.firstName||"",lastName:t.lastName||"",email:t.email||"",phonenumber:t.phonenumber||"",username:t.username||"",gender:t.gender||"MALE",national_id:t.national_id||""}),l(null)}catch(e){console.error("Error fetching profile:",e),l("Failed to load profile data. Please try again later.")}finally{r(!1)}})()},[E]),e)?(0,t.jsxs)("div",{className:"flex justify-center items-center h-96",children:[(0,t.jsx)(m,{className:"h-8 w-8 text-[#026FB4] animate-spin"}),(0,t.jsx)("span",{className:"ml-2 text-lg",children:"Loading profile..."})]}):(0,t.jsxs)("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden max-w-5xl mx-auto",children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("div",{className:"absolute inset-0 bg-[#026FB4]"}),(0,t.jsx)("div",{className:"relative h-48",children:(0,t.jsx)("div",{className:"absolute -bottom-16 left-1/2 transform -translate-x-1/2",children:(0,t.jsxs)("div",{className:"flex flex-col items-center",children:[(0,t.jsx)("div",{className:"relative group",children:(0,t.jsx)("div",{className:"w-32 h-32 rounded-full bg-white p-2 shadow-xl transform transition-transform duration-300 group-hover:scale-105",children:(0,t.jsx)("div",{className:"w-full h-full rounded-full bg-gradient-to-br from-gray-100 to-gray-200 flex items-center justify-center",children:(0,t.jsx)(u.A,{className:"h-20 w-20 text-[#026FB4]"})})})}),(0,t.jsxs)("div",{className:"flex flex-col items-center mt-4",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-white",children:A&&"".concat(A.firstName," ").concat(A.lastName)}),(0,t.jsx)("h2",{className:"text-gray-200 bg-[#026FB4]/90 px-3 py-1 rounded-full text-sm font-medium mt-1",children:A&&A.roles&&A.roles.length>0?A.roles[0].role_name:"User"})]})]})})})]}),(0,t.jsxs)("div",{className:"mt-20 px-8 pb-8",children:[a&&(0,t.jsx)(j.Fc,{variant:"destructive",className:"mb-6",children:(0,t.jsxs)(j.TN,{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{children:a}),(a.includes("not authenticated")||a.includes("expired"))&&(0,t.jsx)("button",{onClick:()=>z.push("/login"),className:"bg-red-100 text-red-800 px-3 py-1 rounded-md text-sm font-medium hover:bg-red-200",children:"Go to Login"})]})}),F&&(0,t.jsx)(j.Fc,{className:"mb-6 bg-green-50 border-green-200",children:(0,t.jsx)(j.TN,{className:"text-green-700",children:"Profile updated successfully!"})}),(0,t.jsx)(i.lV,{...E,children:(0,t.jsxs)("form",{onSubmit:E.handleSubmit(I),className:"space-y-8",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)(i.zB,{control:E.control,name:"firstName",render:e=>{let{field:r}=e;return(0,t.jsxs)(i.eI,{children:[(0,t.jsx)(i.lR,{className:"font-medium text-gray-700",children:"First Name"}),(0,t.jsx)(i.MJ,{children:(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(u.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),(0,t.jsx)(d.p,{placeholder:"First name",...r,className:"pl-10 bg-gray-50 border-gray-200 focus:border-[#026FB4] focus:ring-1 focus:ring-[#026FB4]"})]})}),(0,t.jsx)(i.C5,{className:"text-red-500 text-sm"})]})}}),(0,t.jsx)(i.zB,{control:E.control,name:"email",render:e=>{let{field:r}=e;return(0,t.jsxs)(i.eI,{children:[(0,t.jsx)(i.lR,{className:"font-medium text-gray-700",children:"Email"}),(0,t.jsx)(i.MJ,{children:(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(x.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),(0,t.jsx)(d.p,{placeholder:"Email",type:"email",...r,className:"pl-10 bg-gray-50 border-gray-200 focus:border-[#026FB4] focus:ring-1 focus:ring-[#026FB4]"})]})}),(0,t.jsx)(i.C5,{className:"text-red-500 text-sm"})]})}}),(0,t.jsx)(i.zB,{control:E.control,name:"username",render:e=>{let{field:r}=e;return(0,t.jsxs)(i.eI,{children:[(0,t.jsx)(i.lR,{className:"font-medium text-gray-700",children:"Username"}),(0,t.jsx)(i.MJ,{children:(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(g,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),(0,t.jsx)(d.p,{placeholder:"Username",...r,className:"pl-10 bg-gray-50 border-gray-200 focus:border-[#026FB4] focus:ring-1 focus:ring-[#026FB4]"})]})}),(0,t.jsx)(i.C5,{className:"text-red-500 text-sm"})]})}}),(0,t.jsx)(i.zB,{control:E.control,name:"gender",render:e=>{let{field:r}=e;return(0,t.jsxs)(i.eI,{children:[(0,t.jsx)(i.lR,{className:"font-medium text-gray-700",children:"Gender"}),(0,t.jsxs)(p.l6,{onValueChange:r.onChange,defaultValue:r.value,value:r.value,children:[(0,t.jsx)(i.MJ,{children:(0,t.jsx)(p.bq,{className:"bg-gray-50 border-gray-200 focus:border-[#026FB4] focus:ring-1 focus:ring-[#026FB4]",children:(0,t.jsx)(p.yv,{placeholder:"Select gender"})})}),(0,t.jsxs)(p.gC,{children:[(0,t.jsx)(p.eb,{value:"MALE",children:"Male"}),(0,t.jsx)(p.eb,{value:"FEMALE",children:"Female"}),(0,t.jsx)(p.eb,{value:"OTHER",children:"Other"})]})]}),(0,t.jsx)(i.C5,{className:"text-red-500 text-sm"})]})}})]}),(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)(i.zB,{control:E.control,name:"lastName",render:e=>{let{field:r}=e;return(0,t.jsxs)(i.eI,{children:[(0,t.jsx)(i.lR,{className:"font-medium text-gray-700",children:"Last Name"}),(0,t.jsx)(i.MJ,{children:(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(u.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),(0,t.jsx)(d.p,{placeholder:"Last name",...r,className:"pl-10 bg-gray-50 border-gray-200 focus:border-[#026FB4] focus:ring-1 focus:ring-[#026FB4]"})]})}),(0,t.jsx)(i.C5,{className:"text-red-500 text-sm"})]})}}),(0,t.jsx)(i.zB,{control:E.control,name:"phonenumber",render:e=>{let{field:r}=e;return(0,t.jsxs)(i.eI,{children:[(0,t.jsx)(i.lR,{className:"font-medium text-gray-700",children:"Phone Number"}),(0,t.jsx)(i.MJ,{children:(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(f,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),(0,t.jsx)(d.p,{placeholder:"Phone number",type:"tel",...r,className:"pl-10 bg-gray-50 border-gray-200 focus:border-[#026FB4] focus:ring-1 focus:ring-[#026FB4]"})]})}),(0,t.jsx)(i.C5,{className:"text-red-500 text-sm"})]})}}),(0,t.jsx)(i.zB,{control:E.control,name:"national_id",render:e=>{let{field:r}=e;return(0,t.jsxs)(i.eI,{children:[(0,t.jsx)(i.lR,{className:"font-medium text-gray-700",children:"National ID"}),(0,t.jsx)(i.MJ,{children:(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(h.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),(0,t.jsx)(d.p,{placeholder:"National ID",...r,className:"pl-10 bg-gray-50 border-gray-200 focus:border-[#026FB4] focus:ring-1 focus:ring-[#026FB4]"})]})}),(0,t.jsx)(i.C5,{className:"text-red-500 text-sm"})]})}})]})]}),(0,t.jsx)("div",{className:"flex justify-end pt-4",children:(0,t.jsx)("button",{type:"submit",disabled:c,className:"bg-[#026FB4] hover:bg-[#026FB4]/90 text-white font-medium py-3 px-8 rounded-lg transition-all duration-300 transform hover:scale-105 shadow-lg hover:shadow-xl disabled:opacity-70 disabled:cursor-not-allowed flex items-center",children:c?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(m,{className:"mr-2 h-4 w-4 animate-spin"}),"Saving..."]}):"Save Changes"})})]})})]})]})}},49026:(e,r,a)=>{a.d(r,{Fc:()=>o,TN:()=>i});var t=a(95155);a(12115);var s=a(74466),l=a(53999);let n=(0,s.F)("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function o(e){let{className:r,variant:a,...s}=e;return(0,t.jsx)("div",{"data-slot":"alert",role:"alert",className:(0,l.cn)(n({variant:a}),r),...s})}function i(e){let{className:r,...a}=e;return(0,t.jsx)("div",{"data-slot":"alert-description",className:(0,l.cn)("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",r),...a})}},71007:(e,r,a)=>{a.d(r,{A:()=>t});let t=(0,a(19946).A)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},81586:(e,r,a)=>{a.d(r,{A:()=>t});let t=(0,a(19946).A)("credit-card",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]])},82714:(e,r,a)=>{a.d(r,{J:()=>o});var t=a(95155),s=a(12115),l=a(40968),n=a(53999);let o=s.forwardRef((e,r)=>{let{className:a,...s}=e;return(0,t.jsx)(l.b,{ref:r,className:(0,n.cn)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",a),...s})});o.displayName=l.b.displayName},85977:(e,r,a)=>{a.d(r,{H4:()=>F,_V:()=>b,bL:()=>N});var t=a(12115),s=a(46081),l=a(39033),n=a(52712),o=a(63655),i=a(95155),d="Avatar",[c,m]=(0,s.A)(d),[u,x]=c(d),g=t.forwardRef((e,r)=>{let{__scopeAvatar:a,...s}=e,[l,n]=t.useState("idle");return(0,i.jsx)(u,{scope:a,imageLoadingStatus:l,onImageLoadingStatusChange:n,children:(0,i.jsx)(o.sG.span,{...s,ref:r})})});g.displayName=d;var f="AvatarImage",h=t.forwardRef((e,r)=>{let{__scopeAvatar:a,src:s,onLoadingStatusChange:d=()=>{},...c}=e,m=x(f,a),u=function(e,r){let{referrerPolicy:a,crossOrigin:s}=r,l=t.useSyncExternalStore(y,()=>!0,()=>!1),o=t.useRef(null),i=l?(o.current||(o.current=new window.Image),o.current):null,[d,c]=t.useState(()=>v(i,e));return(0,n.N)(()=>{c(v(i,e))},[i,e]),(0,n.N)(()=>{let e=e=>()=>{c(e)};if(!i)return;let r=e("loaded"),t=e("error");return i.addEventListener("load",r),i.addEventListener("error",t),a&&(i.referrerPolicy=a),"string"==typeof s&&(i.crossOrigin=s),()=>{i.removeEventListener("load",r),i.removeEventListener("error",t)}},[i,s,a]),d}(s,c),g=(0,l.c)(e=>{d(e),m.onImageLoadingStatusChange(e)});return(0,n.N)(()=>{"idle"!==u&&g(u)},[u,g]),"loaded"===u?(0,i.jsx)(o.sG.img,{...c,ref:r,src:s}):null});h.displayName=f;var p="AvatarFallback",j=t.forwardRef((e,r)=>{let{__scopeAvatar:a,delayMs:s,...l}=e,n=x(p,a),[d,c]=t.useState(void 0===s);return t.useEffect(()=>{if(void 0!==s){let e=window.setTimeout(()=>c(!0),s);return()=>window.clearTimeout(e)}},[s]),d&&"loaded"!==n.imageLoadingStatus?(0,i.jsx)(o.sG.span,{...l,ref:r}):null});function v(e,r){return e?r?(e.src!==r&&(e.src=r),e.complete&&e.naturalWidth>0?"loaded":"loading"):"error":"idle"}function y(){return()=>{}}j.displayName=p;var N=g,b=h,F=j}}]);