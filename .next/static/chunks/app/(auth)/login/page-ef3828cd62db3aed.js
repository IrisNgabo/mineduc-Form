(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[72],{19946:(e,t,r)=>{"use strict";r.d(t,{A:()=>d});var s=r(12115);let a=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),o=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase()),l=e=>{let t=o(e);return t.charAt(0).toUpperCase()+t.slice(1)},n=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()};var i={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let c=(0,s.forwardRef)((e,t)=>{let{color:r="currentColor",size:a=24,strokeWidth:o=2,absoluteStrokeWidth:l,className:c="",children:d,iconNode:u,...m}=e;return(0,s.createElement)("svg",{ref:t,...i,width:a,height:a,stroke:r,strokeWidth:l?24*Number(o)/Number(a):o,className:n("lucide",c),...m},[...u.map(e=>{let[t,r]=e;return(0,s.createElement)(t,r)}),...Array.isArray(d)?d:[d]])}),d=(e,t)=>{let r=(0,s.forwardRef)((r,o)=>{let{className:i,...d}=r;return(0,s.createElement)(c,{ref:o,iconNode:t,className:n("lucide-".concat(a(l(e))),"lucide-".concat(e),i),...d})});return r.displayName=l(e),r}},30070:(e,t,r)=>{"use strict";r.d(t,{C5:()=>x,MJ:()=>p,eI:()=>f,lR:()=>g,lV:()=>c,zB:()=>u});var s=r(95155),a=r(12115),o=r(99708),l=r(62177),n=r(53999),i=r(82714);let c=l.Op,d=a.createContext({}),u=e=>{let{...t}=e;return(0,s.jsx)(d.Provider,{value:{name:t.name},children:(0,s.jsx)(l.xI,{...t})})},m=()=>{let e=a.useContext(d),t=a.useContext(h),{getFieldState:r}=(0,l.xW)(),s=(0,l.lN)({name:e.name}),o=r(e.name,s);if(!e)throw Error("useFormField should be used within <FormField>");let{id:n}=t;return{id:n,name:e.name,formItemId:"".concat(n,"-form-item"),formDescriptionId:"".concat(n,"-form-item-description"),formMessageId:"".concat(n,"-form-item-message"),...o}},h=a.createContext({});function f(e){let{className:t,...r}=e,o=a.useId();return(0,s.jsx)(h.Provider,{value:{id:o},children:(0,s.jsx)("div",{"data-slot":"form-item",className:(0,n.cn)("grid gap-2",t),...r})})}function g(e){let{className:t,...r}=e,{error:a,formItemId:o}=m();return(0,s.jsx)(i.J,{"data-slot":"form-label","data-error":!!a,className:(0,n.cn)("data-[error=true]:text-destructive",t),htmlFor:o,...r})}function p(e){let{...t}=e,{error:r,formItemId:a,formDescriptionId:l,formMessageId:n}=m();return(0,s.jsx)(o.DX,{"data-slot":"form-control",id:a,"aria-describedby":r?"".concat(l," ").concat(n):"".concat(l),"aria-invalid":!!r,...t})}function x(e){var t;let{className:r,...a}=e,{error:o,formMessageId:l}=m(),i=o?String(null!=(t=null==o?void 0:o.message)?t:""):a.children;return i?(0,s.jsx)("p",{"data-slot":"form-message",id:l,className:(0,n.cn)("text-destructive text-sm",r),...a,children:i}):null}},35169:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(19946).A)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},53999:(e,t,r)=>{"use strict";r.d(t,{cn:()=>o});var s=r(52596),a=r(39688);function o(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,a.QP)((0,s.$)(t))}},55359:(e,t,r)=>{Promise.resolve().then(r.bind(r,90610))},61204:(e,t,r)=>{"use strict";r.d(t,{f:()=>s});let s="https://api.rwandafutureskillsforum.rtbdev.online"},78749:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(19946).A)("eye-off",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]])},82714:(e,t,r)=>{"use strict";r.d(t,{J:()=>n});var s=r(95155),a=r(12115),o=r(40968),l=r(53999);let n=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)(o.b,{ref:t,className:(0,l.cn)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",r),...a})});n.displayName=o.b.displayName},89852:(e,t,r)=>{"use strict";r.d(t,{p:()=>o});var s=r(95155);r(12115);var a=r(53999);function o(e){let{className:t,type:r,...o}=e;return(0,s.jsx)("input",{type:r,"data-slot":"input",className:(0,a.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",t),...o})}},90610:(e,t,r)=>{"use strict";r.d(t,{default:()=>N});var s=r(95155),a=r(12115),o=r(66766),l=r(6874),n=r.n(l),i=r(35169),c=r(78749),d=r(92657),u=r(89852),m=r(90221),h=r(62177),f=r(55594),g=r(23464),p=r(35695),x=r(56671),b=r(30070),v=r(92981);class y{static getInstance(){return y.instance||(y.instance=new y),y.instance}initialize(){let e=(0,v.gf)(),t=(0,v.ve)();e&&(0,v.G6)()&&(this.session={token:e,refreshToken:t,isAuthenticated:!0,user:this.decodeToken(e)})}decodeToken(e){try{let t=e.split(".");if(3!==t.length)return void console.error("Invalid token format");let r=JSON.parse(atob(t[1].replace(/-/g,"+").replace(/_/g,"/")));console.log("Decoded token payload:",r);let s=r.roles||[],a=s.length>0?s[0].role_name:"USER";return{id:r.id,email:r.email,role:a}}catch(e){console.error("Error decoding token:",e);return}}getSession(){return this.session}async setSession(e,t){try{(0,v.WG)(e),t&&(0,v.fE)(t);let r=this.decodeToken(e);if(!r)throw Error("Invalid token format");this.session={token:e,refreshToken:t||this.session.refreshToken,isAuthenticated:!0,user:r},console.log("Session updated:",this.session)}catch(e){throw console.error("Error setting session:",e),this.clearSession(),e}}clearSession(){(0,v.zu)(),this.session={token:null,refreshToken:null,isAuthenticated:!1}}isAuthenticated(){let e=(0,v.gf)();if(!e)return!1;try{let t=e.split(".");if(3!==t.length)return!1;let r=JSON.parse(atob(t[1].replace(/-/g,"+").replace(/_/g,"/"))),s=1e3*r.exp;return Date.now()<s}catch(e){return!1}}getUser(){return this.session.user}constructor(){this.session={token:null,refreshToken:null,isAuthenticated:!1},this.initialize()}}let w=y.getInstance();var j=r(61204);let k=f.z.object({email:f.z.string().email({message:"Please enter a valid email address"}),password:f.z.string().min(6,{message:"Password must be at least 6 characters"})});function N(){let[e,t]=(0,a.useState)(!1),[r,l]=(0,a.useState)(!1),f=(0,p.useRouter)(),v=(0,h.mN)({resolver:(0,m.u)(k),defaultValues:{email:"",password:""}}),y=async e=>{var t,r,s,a,o,n,i,c,d;try{l(!0),console.log("Attempting login with:",e);let s=await g.A.post("".concat(j.f,"/auth/login"),e,{headers:{"Content-Type":"application/json",Accept:"application/json"}});if(console.log("Login response:",s.data),s.data&&s.data.success){let{access:e,refresh_token:t,user:a}=s.data.data;if(e&&t){localStorage.setItem("access",e),localStorage.setItem("refresh_token",t),await w.setSession(e,t),console.log("Session set:",w.getSession());let s="/";if((null==a||null==(r=a.roles)?void 0:r.length)>0){let e=a.roles[0].role_name.toUpperCase();switch(console.log("User role:",e),e){case"ADMIN":s="/admin/dashboard";break;case"COORDINATOR":s="/coordinator/dashboard";break;case"EVENT_ORGANIZER":s="/event-organizer/dashboard";break;default:s="/"}}x.o.success("Login successful! Redirecting..."),f.push(s);return}throw console.error("No access token in response:",s.data),Error("Login successful but no access token received")}throw Error((null==(t=s.data)?void 0:t.message)||"Login failed")}catch(e){if(console.error("Login error:",e),g.A.isAxiosError(e)){let t=(null==(a=e.response)||null==(s=a.data)?void 0:s.message)||(null==(n=e.response)||null==(o=n.data)?void 0:o.error)||(null==(d=e.response)||null==(c=d.data)||null==(i=c.data)?void 0:i.message)||"Login failed. Please check your credentials and try again.";x.o.error(t)}else e instanceof Error?x.o.error(e.message):x.o.error("An unexpected error occurred. Please try again later.")}finally{l(!1)}};return(0,s.jsxs)("div",{className:"flex min-h-screen bg-[#F9F9F9] relative",children:[(0,s.jsxs)(n(),{href:"/landing",className:"absolute top-6 left-6 flex items-center text-[#0071bc] hover:text-[#005a96] transition-colors font-medium z-10",children:[(0,s.jsx)(i.A,{className:"mr-1",size:20}),(0,s.jsx)("span",{children:"Back"})]}),(0,s.jsx)("div",{className:"flex flex-col items-center justify-center w-full px-8 lg:w-1/2",children:(0,s.jsxs)("div",{className:"w-full max-w-md mx-auto",children:[(0,s.jsx)("div",{className:"flex justify-center mb-12",children:(0,s.jsx)(o.default,{src:"/eac.jpeg",alt:"Rwanda FutureSkills Forum Logo",width:240,height:70,priority:!0,className:"object-contain mx-auto"})}),(0,s.jsxs)("div",{className:"w-full mx-auto",children:[(0,s.jsx)("h1",{className:"text-3xl font-medium text-gray-900 mb-1 text-center",children:"Log in to your Account"}),(0,s.jsx)("p",{className:"text-gray-500 text-sm mb-8 text-center",children:"Fill in the form to continue"}),(0,s.jsx)(b.lV,{...v,children:(0,s.jsxs)("form",{onSubmit:v.handleSubmit(y),className:"space-y-5",children:[(0,s.jsx)(b.zB,{control:v.control,name:"email",render:e=>{let{field:t}=e;return(0,s.jsxs)(b.eI,{children:[(0,s.jsx)(b.MJ,{children:(0,s.jsx)(u.p,{type:"email",placeholder:"Email",className:"px-4 py-2.5 h-auto border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",...t})}),(0,s.jsx)(b.C5,{className:"text-sm text-red-500"})]})}}),(0,s.jsx)(b.zB,{control:v.control,name:"password",render:r=>{let{field:a}=r;return(0,s.jsxs)(b.eI,{children:[(0,s.jsx)(b.MJ,{children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(u.p,{type:e?"text":"password",placeholder:"Password",className:"px-4 py-2.5 h-auto pr-10 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",...a}),(0,s.jsx)("button",{type:"button",className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400",onClick:()=>t(!e),children:e?(0,s.jsx)(c.A,{size:18}):(0,s.jsx)(d.A,{size:18})})]})}),(0,s.jsx)(b.C5,{className:"text-sm text-red-500"})]})}}),(0,s.jsx)("div",{children:(0,s.jsx)(n(),{href:"/forgot",className:"text-sm text-gray-500 hover:text-blue-600",children:"Forgot password?"})}),(0,s.jsx)("button",{type:"submit",disabled:r,className:"w-full py-3 bg-[#0071bc] hover:bg-[#005a96] text-white rounded-full font-medium transition-colors mx-auto disabled:opacity-50 disabled:cursor-not-allowed",children:r?"Logging in...":"Login"})]})})]})]})}),(0,s.jsx)("div",{className:"hidden lg:block lg:w-1/2",children:(0,s.jsx)("div",{className:"h-[90vh] w-[95%] relative mx-auto top-9",children:(0,s.jsx)(o.default,{src:"/background_v1.svg",alt:"Smart City Illustration",fill:!0,className:"object-contain",priority:!0})})})]})}},92657:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(19946).A)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},92981:(e,t,r)=>{"use strict";r.d(t,{G6:()=>d,WG:()=>n,fE:()=>i,gf:()=>o,ve:()=>l,zu:()=>c});let s="access",a="refresh_token",o=()=>localStorage.getItem(s),l=()=>localStorage.getItem(a),n=e=>{localStorage.setItem(s,e)},i=e=>{localStorage.setItem(a,e)},c=()=>{localStorage.removeItem(s),localStorage.removeItem(a)},d=()=>{let e=o();if(!e)return!1;try{let t=JSON.parse(atob(e.split(".")[1])),r=1e3*t.exp;return Date.now()<r}catch(e){return console.error("Error checking token validity:",e),!1}}}},e=>{var t=t=>e(e.s=t);e.O(0,[2848,6671,6874,3063,5521,8146,7618,8441,1684,7358],()=>t(55359)),_N_E=e.O()}]);