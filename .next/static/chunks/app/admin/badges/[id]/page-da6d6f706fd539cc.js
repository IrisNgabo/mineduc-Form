(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9147],{24956:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>p});var t=a(95155),r=a(12115),o=a(97168),l=a(35169),i=a(91788),n=a(66766),d=a(10001),c=a(87620),m=a(6874),h=a.n(m),x=a(35695),u=a(88482),g=a(92981),f=a(56671),w=a(78064),b=a(61204);function p(){let e=(0,x.useParams)(),s=(0,r.useRef)(null),a=(0,r.useRef)(null),m=(0,r.useRef)(null),[p,v]=(0,r.useState)(null),[N,j]=(0,r.useState)(!0),[y,F]=(0,r.useState)(null),[B,k]=(0,r.useState)(!1),[E,C]=(0,r.useState)(null),[P,S]=(0,r.useState)(""),[_,A]=(0,r.useState)("");(0,r.useEffect)(()=>{A(window.location.origin),console.log(_)},[_]),(0,r.useEffect)(()=>{(async()=>{try{j(!0),F(null);let s=(0,g.gf)();if(!s){F("Your session has expired. Please login again."),f.o.error("Your session has expired. Please login again."),window.location.href="/login";return}let a=e.id||"a410a68c-523c-4bd5-8d9d-ec11bab2d2f9",t=await fetch("".concat(b.f,"/delegates/").concat(a),{headers:{Authorization:"Bearer ".concat(s),accept:"*/*"}});if(!t.ok){if(401===t.status){F("Your session has expired. Please login again."),f.o.error("Your session has expired. Please login again."),window.location.href="/login";return}throw Error("Failed to fetch delegate")}let r=await t.json();if(v(r),r.profile_picture_url)try{await D(r.profile_picture_url)}catch(e){console.warn("Could not preload profile image:",e)}}catch(e){console.error("Error fetching delegate:",e),F(e instanceof Error?e.message:"An error occurred")}finally{j(!1)}})()},[e.id]),(0,r.useEffect)(()=>{if(!P){let e=Math.floor(500*Math.random())+1;S("RFF".concat(String(e).padStart(3,"0")))}},[P]);let D=e=>new Promise((s,a)=>{let t=document.createElement("img");t.crossOrigin="anonymous",t.onload=()=>{let e=document.createElement("canvas");e.width=t.width,e.height=t.height;let r=e.getContext("2d");if(!r)return void a(Error("Could not get canvas context"));r.drawImage(t,0,0);try{let a=e.toDataURL("image/png");C(a),s()}catch(e){a(e)}},t.onerror=()=>a(Error("Failed to load image")),t.src=e}),L=async(e,s)=>{let a=document.getElementById(e);if(!a)return void f.o.error('Element with ID "'.concat(e,'" not found'));try{let e=a.getBoundingClientRect(),t=document.createElement("canvas");t.width=e.width,t.height=e.height;let r=await (0,w.$E)(a,{quality:.95,pixelRatio:2,skipFonts:!0,cacheBust:!0,backgroundColor:"#ffffff"}),o=document.createElement("a");return o.download=s,o.href=r,document.body.appendChild(o),o.click(),document.body.removeChild(o),!0}catch(e){return console.error("Error in downloadUsingCanvas:",e),!1}},M=async()=>{if(!p)return;k(!0);let e=f.o.loading("Preparing your badge for download...");try{if(await L("combined-badge","badge-".concat(p.firstName.toLowerCase(),"-").concat(p.lastName.toLowerCase(),".png")))f.o.dismiss(e),f.o.success("Badge downloaded successfully!");else throw Error("Failed to generate badge image")}catch(s){console.error("Error downloading badge:",s),f.o.dismiss(e),f.o.error("Failed to download badge. Please try again.")}finally{k(!1)}},R=async()=>{if(!p)return;k(!0);let e=f.o.loading("Preparing your badges for download...");try{if(!await L("front-badge","badge-".concat(p.firstName.toLowerCase(),"-").concat(p.lastName.toLowerCase(),"-front.png")))throw Error("Failed to generate front badge image");if(await new Promise(e=>setTimeout(e,500)),!await L("back-badge","badge-".concat(p.firstName.toLowerCase(),"-").concat(p.lastName.toLowerCase(),"-back.png")))throw Error("Failed to generate back badge image");f.o.dismiss(e),f.o.success("Badges downloaded successfully!")}catch(s){console.error("Error downloading badges:",s),f.o.dismiss(e),f.o.error("Failed to download badges. Please try again.")}finally{k(!1)}};if(N)return(0,t.jsx)("div",{className:"flex flex-col items-center justify-center min-h-[50vh] gap-4",children:(0,t.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-[#026FB4]"})});if(y||!p)return(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-[50vh] gap-4",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold",children:"Delegate not found"}),(0,t.jsx)(h(),{href:"/admin/badges",children:(0,t.jsxs)(o.$,{variant:"outline",className:"flex items-center gap-2",children:[(0,t.jsx)(l.A,{className:"h-4 w-4"}),"Back to Badges"]})})]});let $=p.workshops||[];return(0,t.jsx)("div",{className:"container mx-auto p-6",children:(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50/50",children:[(0,t.jsxs)("div",{className:"mb-8 flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between bg-white p-6 shadow-sm",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)(h(),{href:"/admin/badges",children:(0,t.jsx)(o.$,{variant:"ghost",size:"icon",className:"hover:bg-gray-100",children:(0,t.jsx)(l.A,{className:"h-5 w-5"})})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-bold sm:text-3xl",children:"Badge Preview"}),(0,t.jsxs)("p",{className:"text-sm text-muted-foreground mt-1",children:["Preview and generate badge for ",p.firstName," ",p.lastName]})]})]}),(0,t.jsx)(c.F,{})]}),(0,t.jsx)("div",{className:"container mx-auto px-4 pb-12",children:(0,t.jsx)(u.Zp,{className:"p-8 bg-white shadow-md",children:(0,t.jsxs)("div",{className:"space-y-12",children:[(0,t.jsxs)("div",{id:"combined-badge",ref:s,className:"grid gap-12 mx-auto md:grid-cols-2 max-w-[1000px]",children:[(0,t.jsxs)("div",{id:"front-badge",ref:a,className:"relative h-[500px] w-[380px] overflow-hidden rounded-2xl border-2 bg-white p-6 shadow-lg mx-auto hover:shadow-xl transition-shadow duration-200",children:[(0,t.jsxs)("div",{className:"absolute inset-0",children:[(0,t.jsx)("div",{className:"absolute -left-12 -top-12 h-24 w-48 rotate-45 bg-[#026FB4]/20"}),(0,t.jsx)("div",{className:"absolute -right-12 -top-12 h-24 w-48 rotate-45 bg-[#026FB4]/20"}),(0,t.jsx)("div",{className:"absolute bottom-0 left-0 right-0 h-48 bg-gradient-to-t from-[#026FB4]/10"})]}),(0,t.jsxs)("div",{className:"relative flex h-full flex-col items-center py-4",children:[(0,t.jsxs)("div",{className:"flex-1 flex flex-col items-center justify-center space-y-4",children:[(0,t.jsx)(n.default,{src:"/logo.svg",alt:"FutureSkills Logo",width:160,height:45,className:"mb-2"}),(0,t.jsx)("div",{className:"relative h-28 w-28 overflow-hidden rounded-full border-4 border-[#026FB4] shadow-md",children:E?(0,t.jsx)(n.default,{src:E||"/placeholder.svg",alt:"".concat(p.firstName," ").concat(p.lastName,"'s photo"),fill:!0,className:"object-cover",unoptimized:!0,priority:!0}):(0,t.jsx)(n.default,{src:p.profile_picture_url||"/man.svg",alt:"".concat(p.firstName," ").concat(p.lastName,"'s photo"),fill:!0,className:"object-cover",crossOrigin:"anonymous",onError:e=>{e.target.src="/man.svg"}})}),(0,t.jsxs)("div",{className:"text-center space-y-1",children:[(0,t.jsxs)("h3",{className:"text-2xl font-bold text-[#026FB4]",children:[p.firstName," ",p.lastName]}),(0,t.jsx)("p",{className:"text-base text-gray-600 font-medium",children:p.position}),(0,t.jsx)("p",{className:"text-base text-gray-600",children:p.organization})]})]}),(0,t.jsx)("div",{className:"mt-auto",children:(0,t.jsx)("div",{className:"rounded-xl border-2 border-[#026FB4] bg-white p-2 shadow-md",children:(0,t.jsx)(d.r,{value:"http://rwandafutureskillsforum.rtb.gov.rw/verify/".concat(p.id),size:100,className:"rounded-lg"})})})]})]}),(0,t.jsxs)("div",{id:"back-badge",ref:m,className:"relative h-[500px] w-[380px] overflow-hidden rounded-2xl border-2 bg-white p-6 shadow-lg mx-auto hover:shadow-xl transition-shadow duration-200",children:[(0,t.jsxs)("div",{className:"absolute inset-0",children:[(0,t.jsx)("div",{className:"absolute -left-12 -top-12 h-24 w-48 rotate-45 bg-[#026FB4]/20"}),(0,t.jsx)("div",{className:"absolute -right-12 -top-12 h-24 w-48 rotate-45 bg-[#026FB4]/20"})]}),(0,t.jsxs)("div",{className:"relative flex h-full flex-col",children:[(0,t.jsxs)("div",{className:"mb-4 rounded-xl bg-gradient-to-r from-[#026FB4]/10 via-[#026FB4]/20 to-[#026FB4]/10 p-3 text-center shadow-sm",children:[(0,t.jsx)("p",{className:"text-base font-semibold text-[#026FB4]",children:"Delegate ID"}),(0,t.jsx)("p",{className:"mt-0.5 font-mono text-lg font-bold tracking-wider text-[#026FB4]",children:function(e){let s=0;for(let a=0;a<e.length;a++)s=e.charCodeAt(a)+((s<<5)-s);let a=Math.abs(s%500)+1;return"RFF".concat(String(a).padStart(3,"0"))}(p.id)})]}),(0,t.jsx)("h4",{className:"mb-4 text-center text-lg font-semibold text-[#026FB4]",children:"Your Workshops"}),(0,t.jsx)("div",{className:"flex-1 space-y-3 overflow-y-auto",children:$.map(e=>{let{date:s,time:a}=function(e){let{id:s,title:a}=e,t=a.toLowerCase();return["ws1","ws2","ws3","ws4"].includes(s)||t.includes("quality")||t.includes("relevance")||t.includes("inclusion")||t.includes("innovation")&&!t.includes("ecosystem")?{date:"June 4, 2025",time:"11:30 AM to 1:00 PM"}:["ws5","ws6","ws7","ws8"].includes(s)||t.includes("skills outlook")||t.includes("emerging technologies")||t.includes("inclusive workforce")||t.includes("innovation")&&t.includes("ecosystem")?{date:"June 4, 2025",time:"14:30 PM to 16:00 PM"}:{date:"TBD",time:"TBD"}}(e);return(0,t.jsxs)("div",{className:"rounded-xl border-2 border-[#026FB4]/20 bg-[#026FB4]/5 p-3 shadow-sm transition-all duration-200 hover:bg-[#026FB4]/10 hover:shadow-md",children:[(0,t.jsx)("p",{className:"text-sm font-bold text-gray-800",children:e.title}),(0,t.jsxs)("div",{className:"mt-2 flex flex-col",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)("span",{className:"text-xs font-medium text-[#026FB4]",children:"Venue:"}),(0,t.jsx)("span",{className:"text-xs text-gray-700",children:e.venue})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)("span",{className:"text-xs font-medium text-[#026FB4]",children:"Date:"}),(0,t.jsx)("span",{className:"text-xs text-gray-700",children:s})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)("span",{className:"text-xs font-medium text-[#026FB4]",children:"Time:"}),(0,t.jsx)("span",{className:"text-xs text-gray-700",children:a})]})]})]},e.id)})}),(0,t.jsx)("div",{className:"mt-4 text-center",children:(0,t.jsx)("p",{className:"text-sm font-medium text-[#026FB4]/60",children:"Please keep this badge with you at all times"})})]})]})]}),(0,t.jsxs)("div",{className:"flex w-full flex-col gap-4 sm:flex-row sm:gap-6 sm:justify-center",children:[(0,t.jsxs)(o.$,{onClick:M,style:{backgroundColor:"#026FB4"},className:"flex items-center justify-center gap-3 text-base py-6 px-8 hover:bg-blue-700",disabled:B,children:[(0,t.jsx)(i.A,{className:"h-5 w-5"}),B?"Preparing...":"Download Combined Badge"]}),(0,t.jsxs)(o.$,{onClick:R,variant:"outline",style:{borderColor:"#026FB4",color:"#026FB4"},className:"flex items-center justify-center gap-3 text-base py-6 px-8 hover:bg-blue-50",disabled:B,children:[(0,t.jsx)(i.A,{className:"h-5 w-5"}),"Download Front & Back Separately"]}),(0,t.jsxs)(o.$,{onClick:()=>{if(!p)return;k(!0);let e=f.o.loading("Preparing download instructions...");try{f.o.dismiss(e),f.o.info("Please take a screenshot of each badge and save it manually. On most computers, you can use: Windows (Win+Shift+S), Mac (Cmd+Shift+4), or your browser's screenshot tool.",{duration:8e3})}catch(s){f.o.dismiss(e),f.o.error("An error occurred. Please try taking a screenshot manually."),console.error("Error in fallback download:",s)}finally{k(!1)}},variant:"ghost",className:"flex items-center justify-center gap-3 text-base py-6 px-8 hover:bg-gray-100",disabled:B,children:[(0,t.jsx)(i.A,{className:"h-5 w-5"}),"Screenshot Instructions"]})]})]})})})]})})}},99937:(e,s,a)=>{Promise.resolve().then(a.bind(a,24956))}},e=>{var s=s=>e(e.s=s);e.O(0,[2848,6671,1478,5364,8698,6874,3063,3350,2740,8441,1684,7358],()=>s(99937)),_N_E=e.O()}]);